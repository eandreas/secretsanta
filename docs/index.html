---

title: Secret Santa


keywords: fastai
sidebar: home_sidebar

summary: "This module allows to send emails in the name of Secret Santa using an SMTP email server."
description: "This module allows to send emails in the name of Secret Santa using an SMTP email server."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This file will become your README and also the index of your documentation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install your_project_name</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Please folllow the example below to create and send e-mails from Secret Santa.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">secretsanta.core</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">pathlib2</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sender_name</span> <span class="o">=</span> <span class="s1">&#39;Santa Claus&#39;</span>
<span class="n">sender_email</span> <span class="o">=</span> <span class="s1">&#39;santa@claus.com&#39;</span>
<span class="n">subject</span> <span class="o">=</span> <span class="s1">&#39;Christmas Lottery&#39;</span>
<span class="n">input_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;input_data&#39;</span><span class="p">)</span>

<span class="n">lottery</span> <span class="o">=</span> <span class="n">SecretSanta</span><span class="p">(</span><span class="n">sender_name</span><span class="p">,</span> <span class="n">sender_email</span><span class="p">,</span> <span class="n">subject</span><span class="p">,</span> <span class="n">input_path</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Participants:
-------------
John Doe (en, m): john.doe@gmail.com
Jane Doe (en, f): jane.doe@gmail.com
Hans Muster (de, m): hans.muster@gmail.com
Marta Muster (de, f): marta.muster@gmail.com
-------------
Rule [must] failed: John --&gt; Marta
Rule [must] failed: John --&gt; Marta
Rule [not] failed: Hans --&gt; Marta
Rule [must] failed: John --&gt; Marta
Rule [not] failed: Jane --&gt; John
Rule [not] failed: Marta --&gt; Hans
Rule [not] failed: Hans --&gt; Marta
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lottery</span><span class="o">.</span><span class="n">print_assignments</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Participants --&gt; Presemtees:
----------------------------
John --&gt; Marta
Jane --&gt; Hans
Hans --&gt; Jane
Marta --&gt; John
----------------------------
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Send-Mail-from-disk">Send Mail from disk<a class="anchor-link" href="#Send-Mail-from-disk"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">email.parser</span> <span class="kn">import</span> <span class="n">BytesParser</span>
<span class="kn">from</span> <span class="nn">email</span> <span class="kn">import</span> <span class="n">policy</span>

<span class="c1"># set user and password of the smtp server</span>
<span class="n">user</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">pw</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Jane&#39;</span>
<span class="n">fn_email</span> <span class="o">=</span> <span class="n">input_path</span> <span class="o">/</span> <span class="sa">f</span><span class="s1">&#39;message_</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">.msg&#39;</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn_email</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">email</span> <span class="o">=</span> <span class="n">BytesParser</span><span class="p">(</span><span class="n">policy</span><span class="o">=</span><span class="n">policy</span><span class="o">.</span><span class="n">default</span><span class="p">)</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>

<span class="c1"># uncomment after setting user and pw above</span>
<span class="c1">#send_smtp_email(&#39;host&#39;, port, user, pw, email)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;To:&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;to&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;From:&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;from&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Subject:&#39;</span><span class="p">,</span> <span class="n">email</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>To: jane.doe@gmail.com
From: Santa Claus &lt;santa@claus.com&gt;
Subject: Christmas Lottery
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">richest</span> <span class="o">=</span> <span class="n">email</span><span class="o">.</span><span class="n">get_body</span><span class="p">()</span>
<span class="n">body</span> <span class="o">=</span> <span class="n">richest</span><span class="o">.</span><span class="n">get_body</span><span class="p">(</span><span class="n">preferencelist</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">))</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get_content</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;title&gt;Secret Santa&lt;/title&gt;
    &lt;link rel=&#34;preconnect&#34; href=&#34;https://fonts.gstatic.com&#34;&gt;
    &lt;link href=&#34;https://fonts.googleapis.com/css2?family=Montserrat:wght@200&amp;display=swap&#34; rel=&#34;stylesheet&#34;&gt;
    &lt;style&gt;
        div.main {
            font-family: &#39;Montserrat&#39;, sans-serif;
            font-size: 14px;
            max-width: 600px;
            margin: 20px 10% 10px 10%;
        }
    &lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div class=&#34;main&#34;&gt;
        &lt;img src=&#34;cid:santa.jpg&#34; alt=&#34;Santa Claus Image&#34; width=&#34;auto&#34;&gt;
        &lt;h1&gt;Xmas Lottery 2020&lt;/h1&gt;
        &lt;p&gt;Dear Jane&lt;/p&gt;
        &lt;p&gt;Soon it will be Christmas again. Unfortunately, I am far behind with my preparations, so that I am dependent
            on
            your help.
        &lt;/p&gt;
        &lt;p&gt;Could you organize a little present for &lt;b&gt;Hans&lt;/b&gt; until Christmas and secretly put it under the
            Christmas tree? That would be really wonderful ...
        &lt;/p&gt;
        &lt;p&gt;Best regards&lt;br&gt;Santa Claus&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">IPython</span>

<span class="n">html</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cid:santa.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;input_data/santa.jpg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
    &lt;title&gt;Secret Santa&lt;/title&gt;
    &lt;link rel=&#34;preconnect&#34; href=&#34;https://fonts.gstatic.com&#34;&gt;
    &lt;link href=&#34;https://fonts.googleapis.com/css2?family=Montserrat:wght@200&amp;display=swap&#34; rel=&#34;stylesheet&#34;&gt;
    &lt;style&gt;
        div.main {
            font-family: &#39;Montserrat&#39;, sans-serif;
            font-size: 14px;
            max-width: 600px;
            margin: 20px 10% 10px 10%;
        }
    &lt;/style&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;div class=&#34;main&#34;&gt;
        &lt;img src=&#34;input_data/santa.jpg&#34; alt=&#34;Santa Claus Image&#34; width=&#34;auto&#34;&gt;
        &lt;h1&gt;Xmas Lottery 2020&lt;/h1&gt;
        &lt;p&gt;Dear Jane&lt;/p&gt;
        &lt;p&gt;Soon it will be Christmas again. Unfortunately, I am far behind with my preparations, so that I am dependent
            on
            your help.
        &lt;/p&gt;
        &lt;p&gt;Could you organize a little present for &lt;b&gt;Hans&lt;/b&gt; until Christmas and secretly put it under the
            Christmas tree? That would be really wonderful ...
        &lt;/p&gt;
        &lt;p&gt;Best regards&lt;br&gt;Santa Claus&lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;

</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">IPython</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<!DOCTYPE html>
<html>

<head>
    <title>Secret Santa</title>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200&display=swap" rel="stylesheet">
    <style>
        div.main {
            font-family: 'Montserrat', sans-serif;
            font-size: 14px;
            max-width: 600px;
            margin: 20px 10% 10px 10%;
        }
    </style>
</head>

<body>
    <div class="main">
        <img src="https://github.com/eandreas/secretsanta/raw/master/input_data/santa.jpg" alt="Santa Claus Image" width="auto">
        <h1>Xmas Lottery 2020</h1>
        <p>Dear Jane</p>
        <p>Soon it will be Christmas again. Unfortunately, I am far behind with my preparations, so that I am dependent
            on
            your help.
        </p>
        <p>Could you organize a little present for <b>Hans</b> until Christmas and secretly put it under the
            Christmas tree? That would be really wonderful ...
        </p>
        <p>Best regards<br>Santa Claus</p>
    </div>
</body>

</html>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

